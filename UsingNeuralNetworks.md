# Using Neural Networks

The LearningFramwork allows the use of Neural Networks for classification
and sequence tagging through two different backends:

* Pytorch - based on the Python [Pytorch](https://pytorch.org/) library.
  This backend provides the algorithms:
  * `PytorchWrapper_CL_DR` for processing classification instances
  * `PytorchWrapper_SEQ_DR` for processing sequence tagging instances
* Keras - based on the Python [Keras](https://keras.io/) library.
  This backend provides the algorithms:
  * `KerasWrapper_CL_DR` for processing classification instances
  * `KerasWrapper_SEQ_DR` for processing classification instances

## Documentation for Using Neural Networks

* Installation (below)
* Overview (below)
* [PytorchWrapper](DnnPytorchWrapper) -- how to use the PytorchWrapper
* [KerasWrapper](DnnKerasWrapper) -- (NOT YET) how to use the KerasWrapper
* [gate-lf-python-data](https://gatenlp.github.io/gate-lf-python-data/) -- a python library used by both wrappers to
  access the JSON-format instance data generated by the LearningFramework
* [gatel-lf-pytorch-json](https://gatenlp.github.io/gate-lf-pytorch-json/) -- the python library that implements Pytorch support
* [gate-lf-keras-json](https://github.com/GateNLP/gate-lf-keras-json) -- the python library that implements Keras support
* NOTE: the `gate-lf-` libraries are included in the plugin and do NOT need to
  get installed seaparately!

## Installation

IMPORTANT: at the moment, only Linux and MacOS are supported, however
Windows support is planned to get added soon!

For both backends:
* For both backends, Python version 3.5 or newer must be installed
* The Python interpreter must be on the path as either `python` or `python3`
* If a GPU should get used, the driver for the GPU mist be installed
* Note: CUDA or cuDNN do not have to be installed for Pytorch, but need to
  installed correctly for Keras (see Pytorch/Keras specific instructions below)
  However installing the CUDA toolkit separately provides useful commands
  and support for monitoring the GPU

Installation of Python:
* Python and python packages can be installed in many different ways, use whatever
  method you prefer
* The developers have found that using Anaconda or Miniconda to install and
  use Python has a number of advantages:
  * easy to install by the user, even if installation for the whole system by an administrator
    is not possible
  * can install versions of Python or the python package which may not be available for the OS release
  * some packages come with optimized maths libraries
  * can use conda install for conda-supported packages and pip install for other packages

### Installation for PytorchWrapper

* Install Pytorch version 0.4 or newer. There are various version of Pytorch
  available for different versions of Python and coming with different versions of CUDA.
  If you already have CUDA installed on your system, it is best to pick the version
  that matches the CUDA version. Otherwise, use the most recent version of CUDA unless
  you have no GPU or you have old GPU hardware which is only supported by earlier CUDA versions.
  * For anaconda Python, Python version 3.6 use `conda install pytorch torchvision -c pytorch`
* Python package numpy is required but may already get installed as a dependency of Pytorch

### Installation for KerasWrapper

* Install Keras version 2.1 or newer. This will automatically also install a number of additional
  packages, including Tensorflow and Tensorboard
* For GPU support under Keras: TO BE DONE!!!
